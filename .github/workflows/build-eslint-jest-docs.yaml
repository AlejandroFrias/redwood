name: Lint, Build & Test

on:
  pull_request:
    types: [opened, synchronize, reopened]
    paths: ['docs/**']

jobs:
  all:
    strategy:
      matrix:
        os: ['ubuntu-latest', 'windows-latest']
        node-version: ['14', '16.10']
      fail-fast: true
    runs-on: ${{ matrix.os }}
    name: ${{ matrix.os }} | Node ${{ matrix.node-version }} latest
    steps:
      - uses: actions/checkout@v3

      - name: Install dependencies
        run: yarn install --immutable

      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v18.4

      - name: Docs
        id: docs
        uses: ./.github/actions/docs
        with:
          changed_files: ${{ steps.changed-files.outputs.all_changed_files }}

      - name: Get output
        run: echo ${{ steps.docs.outputs.should_skip }}

      - name: Test equality
        if: ${{ steps.docs.outputs.should_skip == true }}
        run: 'echo "No lint, build, & test required"'

      - name: Test equality
        if: ${{ steps.docs.outputs.should_skip != true }}
        run: 'echo "running ci..."'
